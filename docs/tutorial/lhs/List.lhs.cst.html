
<pre><span class=hs-linenum>2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>List</span> <span class='hs-keyword'>where</span>
</pre>

<h1 id="recursive-invariants">Recursive Invariants</h1>
<p>Remember the definition of List</p>
<pre><span class=hs-linenum>10: </span><span class='hs-keyword'>infixr</span> <span class='hs-varop'>`C`</span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>L</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
</pre>

<p>We can parameterize the definition with an abstract refinement <code>p</code> that relates the head of the list with all the elements of the tail:</p>
<pre><span class=hs-linenum>18: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>L</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prop</span><span class='hs-varop'>&gt;</span>
<span class=hs-linenum>19: </span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> 
<span class=hs-linenum>20: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>tl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>21: </span>  <span class='hs-keyword'>@-}</span>
</pre>

Consider a list with three elements:
<pre><span class=hs-linenum>25: </span><span class='hs-definition'>h1</span> <span class='hs-varop'>`C`</span> <span class='hs-varid'>h2</span> <span class='hs-varop'>`C`</span> <span class='hs-varid'>h3</span> <span class='hs-varop'>`C`</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span> 
</pre>

If we unfold the list once we get:
<pre><span class=hs-linenum>29: </span><span class='hs-definition'>h1</span>              <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>30: </span><span class='hs-definition'>h2</span> <span class='hs-varop'>`C`</span> <span class='hs-varid'>h3</span> <span class='hs-varop'>`C`</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span><span class='hs-varop'>&gt;</span> 
</pre>

With a second unfold we get:
<pre><span class=hs-linenum>34: </span><span class='hs-definition'>h1</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>35: </span><span class='hs-definition'>h2</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span><span class='hs-varop'>&gt;</span>  
<span class=hs-linenum>36: </span><span class='hs-definition'>h3</span> <span class='hs-varop'>`C`</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>p</span> <span class='hs-varid'>h2</span><span class='hs-varop'>&gt;</span> 
</pre>

Finally, with one more unfold we get:
<pre><span class=hs-linenum>40: </span><span class='hs-definition'>h1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>h2</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span><span class='hs-varop'>&gt;</span>  
<span class=hs-linenum>42: </span><span class='hs-definition'>h3</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>p</span> <span class='hs-varid'>h2</span><span class='hs-varop'>&gt;</span>  
<span class=hs-linenum>43: </span><span class='hs-conid'>N</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>p</span> <span class='hs-varid'>h2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>p</span> <span class='hs-varid'>h3</span><span class='hs-varop'>&gt;</span> 
</pre>
<p>So <code>p</code> hold between <em>every pair</em> of elements in the list.</p>
<p>Consinder instantiating the abstract refinement with a concrete one stating that the value is less than the head, expressing increasing lists:</p>
<pre><span class=hs-linenum>52: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SL</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>hd</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>hd</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
</pre>

<p>We can verify that a random increasing list actually enjoys this type.</p>
<pre><span class=hs-linenum>57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>slist</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SL</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>58: </span><span class='hs-definition'>slist</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>59: </span><a class=annot href="#"><span class=annottext>(List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; (GHC.Types.Int))</span><span class='hs-definition'>slist</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#2620 : (GHC.Types.Int) | (VV#2620 == (1  :  int)) &amp;&amp; (VV#2620 == lq_anf__dDJ)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: (GHC.Types.Int)-&gt; (GHC.Types.Int)-&gt; Bool&gt;.
h_List.C:{VV#2644 : (GHC.Types.Int) | k_2645}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2644 : (GHC.Types.Int)&lt;p h_List.C&gt; | k_2645})
-&gt; (List.L &lt;p&gt; {VV#2644 : (GHC.Types.Int) | k_2645})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV#2621 : (GHC.Types.Int) | (VV#2621 == (6  :  int)) &amp;&amp; (VV#2621 == lq_anf__dDK)}</span><span class='hs-num'>6</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: (GHC.Types.Int)-&gt; (GHC.Types.Int)-&gt; Bool&gt;.
h_List.C:{VV#2637 : (GHC.Types.Int) | k_2638}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2637 : (GHC.Types.Int)&lt;p h_List.C&gt; | k_2638})
-&gt; (List.L &lt;p&gt; {VV#2637 : (GHC.Types.Int) | k_2638})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV#2622 : (GHC.Types.Int) | (VV#2622 == (12  :  int)) &amp;&amp; (VV#2622 == lq_anf__dDL)}</span><span class='hs-num'>12</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: (GHC.Types.Int)-&gt; (GHC.Types.Int)-&gt; Bool&gt;.
h_List.C:{VV#2630 : (GHC.Types.Int) | k_2631}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2630 : (GHC.Types.Int)&lt;p h_List.C&gt; | k_2631})
-&gt; (List.L &lt;p&gt; {VV#2630 : (GHC.Types.Int) | k_2631})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV#2629 : (List.L &lt;\lq_tmp_x2627 VV -&gt; k_2626[VV#2625:=VV]&gt; {VV#2623 : (GHC.Types.Int) | k_2624[VV:=VV#2629]}) | (VV#2629 == lq_anf__dDM)}</span><span class='hs-conid'>N</span></a>
</pre>


<h2 id="insertsort">InsertSort</h2>
<p>More interestingly, we can verify that various <em>recursive</em> sorting algorithms return sorted lists.</p>
<pre><span class=hs-linenum>67: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insert'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SL</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SL</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>68: </span><span class='hs-definition'>insert'</span>     <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>L</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>L</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>69: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
lq_tmp_db3:a
-&gt; lq_tmp_db4:(List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; a)
-&gt; (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; a)</span><span class='hs-definition'>insert'</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <span class='hs-conid'>N</span>                      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#atO)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
h_List.C:{VV#2548 : a | k_2549}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2548 : a&lt;p h_List.C&gt; | k_2549})
-&gt; (List.L &lt;p&gt; {VV#2548 : a | k_2549})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV#2547 : (List.L &lt;\lq_tmp_x2545 VV -&gt; k_2544[VV#2543:=VV]&gt; {VV#2541 : a | k_2542[VV:=VV#2547]}) | (VV#2547 == lq_anf__dDC)}</span><span class='hs-conid'>N</span></a>                           
<span class=hs-linenum>70: </span><span class='hs-definition'>insert'</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-varop'>`C`</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#atO)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>x:{VV#2558 : a | k_2559[_LIQUID_dummy:=fix##36#dOrd#35#ayk]}
-&gt; y:{VV#2558 : a | k_2559[_LIQUID_dummy:=fix##36#dOrd#35#ayk]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &lt;= y))}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#atQ)}</span><span class='hs-varid'>x</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#atO)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
h_List.C:{VV#2594 : a | k_2595}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2594 : a&lt;p h_List.C&gt; | k_2595})
-&gt; (List.L &lt;p&gt; {VV#2594 : a | k_2595})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#atQ)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
h_List.C:{VV#2587 : a | k_2588}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2587 : a&lt;p h_List.C&gt; | k_2588})
-&gt; (List.L &lt;p&gt; {VV#2587 : a | k_2588})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>{VV#2556 : (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV : a | (VV &gt;= x#atQ)}) | (VV#2556 == xs#atR)}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>71: </span>                     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#atQ)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
h_List.C:{VV#2579 : a | k_2580}
-&gt; tl_List.C:(List.L &lt;p&gt; {VV#2579 : a&lt;p h_List.C&gt; | k_2580})
-&gt; (List.L &lt;p&gt; {VV#2579 : a | k_2580})</span><span class='hs-varop'>`C`</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_db3:{VV#2576 : a | k_2577[_LIQUID_dummy:=fix##36#dOrd#35#ayk]}
-&gt; lq_tmp_db4:(List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV#2576 : a | k_2577[_LIQUID_dummy:=fix##36#dOrd#35#ayk]})
-&gt; (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV#2576 : a | k_2577[_LIQUID_dummy:=fix##36#dOrd#35#ayk]})</span><span class='hs-varid'>insert'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#atO)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{VV#2556 : (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV : a | (VV &gt;= x#atQ)}) | (VV#2556 == xs#atR)}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>72: </span>
<span class=hs-linenum>73: </span>
<span class=hs-linenum>74: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insertSort'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SL</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>75: </span><span class='hs-definition'>insertSort'</span>     <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>L</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>76: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
lq_tmp_db6:[a] -&gt; (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; a)</span><span class='hs-definition'>insertSort'</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x1:(lq_tmp_x2:{VV#2611 : a | k_2612}
           -&gt; lq_tmp_x3:{VV#2618 : (List.L &lt;\lq_tmp_x2615 VV -&gt; k_2617&gt; {VV#2613 : a | k_2614}) | k_2619}
           -&gt; {VV#2618 : (List.L &lt;\lq_tmp_x2615 VV -&gt; k_2617&gt; {VV#2613 : a | k_2614}) | k_2619})
-&gt; lq_tmp_x4:{VV#2618 : (List.L &lt;\lq_tmp_x2615 VV -&gt; k_2617&gt; {VV#2613 : a | k_2614}) | k_2619}
-&gt; lq_tmp_x5:[{VV#2611 : a | k_2612}]
-&gt; {VV#2618 : (List.L &lt;\lq_tmp_x2615 VV -&gt; k_2617&gt; {VV#2613 : a | k_2614}) | k_2619}</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_db3:{VV#2601 : a | k_2602[_LIQUID_dummy:=fix##36#dOrd#35#ayp]}
-&gt; lq_tmp_db4:(List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV#2601 : a | k_2602[_LIQUID_dummy:=fix##36#dOrd#35#ayp]})
-&gt; (List.L &lt;\hd VV -&gt; (VV &gt;= hd)&gt; {VV#2601 : a | k_2602[_LIQUID_dummy:=fix##36#dOrd#35#ayp]})</span><span class='hs-varid'>insert'</span></a> <a class=annot href="#"><span class=annottext>{VV#2610 : (List.L &lt;\lq_tmp_x2608 VV -&gt; k_2607[VV#2606:=VV]&gt; {VV#2604 : a | k_2605[VV:=VV#2610]}) | (VV#2610 == lq_anf__dDI)}</span><span class='hs-conid'>N</span></a>
</pre>


<h2 id="on-haskell-lists">On Haskell Lists</h2>
<p><a href="http://goto.ucsd.edu/~rjhala/liquid/haskell/demo/#?demo=ListSort.hs">Demo</a></p>
We have hacked the Haskell List definition to abstract over a refinement:
<pre><span class=hs-linenum>86: </span><span class='hs-keyword'>data</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prop</span><span class='hs-varop'>&gt;</span>
<span class=hs-linenum>87: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span> 
<span class=hs-linenum>88: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conop'>:</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>tl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span> <span class='hs-varid'>h</span><span class='hs-varop'>&gt;</span><span class='hs-keyglyph'>]</span><span class='hs-varop'>&lt;</span><span class='hs-varid'>p</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>89: </span>  <span class='hs-varop'>@-</span><span class='hs-layout'>}</span>
</pre>

<p>So, we can define <code>insertSort</code> on <em>real</em> lists</p>
<pre><span class=hs-linenum>95: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>OList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>fld</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>fld</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>@-}</span>
</pre>

<h2 id="insertsort-1">InsertSort</h2>
<pre><span class=hs-linenum>101: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insertSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>102: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
xs:[a] -&gt; [a]&lt;\fld VV -&gt; (VV &gt;= fld)&gt;</span><span class='hs-definition'>insertSort</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x1:(lq_tmp_x2:{VV#2526 : a | k_2527}
           -&gt; lq_tmp_x3:{VV#2533 : [{VV#2528 : a | k_2529}]&lt;\lq_tmp_x2530 VV -&gt; k_2532&gt; | k_2534}
           -&gt; {VV#2533 : [{VV#2528 : a | k_2529}]&lt;\lq_tmp_x2530 VV -&gt; k_2532&gt; | k_2534})
-&gt; lq_tmp_x4:{VV#2533 : [{VV#2528 : a | k_2529}]&lt;\lq_tmp_x2530 VV -&gt; k_2532&gt; | k_2534}
-&gt; lq_tmp_x5:[{VV#2526 : a | k_2527}]
-&gt; {VV#2533 : [{VV#2528 : a | k_2529}]&lt;\lq_tmp_x2530 VV -&gt; k_2532&gt; | k_2534}</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x2392:{VV#2516 : a | k_2517[fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb] &amp;&amp; k_2394[VV#2393:=VV#2516][fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]}
-&gt; lq_tmp_x2395:{VV#2401 : [{VV#2516 : a | k_2517[fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb] &amp;&amp; k_2397[VV#2396:=VV#2516][fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]}]&lt;\lq_tmp_x2398 VV -&gt; k_2400[VV#2399:=VV][fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]&gt; | k_2402[fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]}
-&gt; {VV#2408 : [{VV#2516 : a | k_2517[fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb] &amp;&amp; k_2404[VV#2403:=VV#2516][fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]}]&lt;\lq_tmp_x2405 VV -&gt; k_2407[VV#2406:=VV][fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]&gt; | k_2409[fix##36#dOrd#35#axU:=fix##36#dOrd#35#ayb]}</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{VV#2525 : [{VV#2519 : a | k_2520[VV:=VV#2525]}]&lt;\lq_tmp_x2523 VV -&gt; k_2522[VV#2521:=VV]&gt; | ((len VV#2525) == 0) &amp;&amp; ((len VV#2525) &gt;= 0) &amp;&amp; (VV#2525 == lq_anf__dDA)}</span><span class='hs-conid'>[]</span></a> <a class=annot href="#"><span class=annottext>{VV#2515 : [a] | ((len VV#2515) &gt;= 0) &amp;&amp; (VV#2515 == xs#atS)}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
y#atT:{VV#2410 : a | k_2411}
-&gt; ds_dBn:{VV#2417 : [{VV#2412 : a | k_2413}]&lt;\lq_tmp_x2414 VV -&gt; k_2416&gt; | k_2418}
-&gt; {VV#2424 : [{VV#2419 : a | k_2420}]&lt;\lq_tmp_x2421 VV -&gt; k_2423&gt; | k_2425}</span><span class='hs-definition'>insert</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_2411[VV#2410:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5]}</span><span class='hs-varid'>y</span></a> <span class='hs-conid'>[]</span>                   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#2458 : [{VV#2452 : a | k_2453[VV:=VV#2458]}]&lt;\lq_tmp_x2456 VV -&gt; k_2455[VV#2454:=VV]&gt; | ((len VV#2458) == 0) &amp;&amp; ((len VV#2458) &gt;= 0) &amp;&amp; (VV#2458 == lq_anf__dDu)}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | k_2411[VV#2410:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5] &amp;&amp; (VV == y#atT)}</span><span class='hs-varid'>y</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>105: </span><span class='hs-definition'>insert</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | k_2411[VV#2410:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5] &amp;&amp; (VV == y#atT)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>x:{VV#2469 : a | k_2470[_LIQUID_dummy:=fix##36#dOrd#35#X5]}
-&gt; y:{VV#2469 : a | k_2470[_LIQUID_dummy:=fix##36#dOrd#35#X5]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &lt;= y))}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_2413[VV#2412:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][VV#2417:=lq_anf__dDt][y:=x#atV][ys:=xs#atW] &amp;&amp; (VV == x#atV)}</span><span class='hs-varid'>x</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_2411[VV#2410:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5] &amp;&amp; (VV == y#atT)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2505 : a | k_2506}
-&gt; ys:[{VV#2505 : a&lt;p y&gt; | k_2506}]&lt;p&gt;
-&gt; {VV : [{VV#2505 : a | k_2506}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_2413[VV#2412:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][VV#2417:=lq_anf__dDt][y:=x#atV][ys:=xs#atW] &amp;&amp; (VV == x#atV)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2498 : a | k_2499}
-&gt; ys:[{VV#2498 : a&lt;p y&gt; | k_2499}]&lt;p&gt;
-&gt; {VV : [{VV#2498 : a | k_2499}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a> <a class=annot href="#"><span class=annottext>{VV#2467 : [{VV : a | k_2413[VV#2412:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][VV#2417:=lq_anf__dDt][y:=x#atV][ys:=xs#atW] &amp;&amp; k_2416[VV#2415:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][lq_tmp_x2414:=x#atV][y:=x#atV][ys:=xs#atW]}]&lt;\lq_tmp_x2414 VV -&gt; k_2416[VV#2415:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][y:=x#atV][ys:=xs#atW]&gt; | ((len VV#2467) &gt;= 0) &amp;&amp; (VV#2467 == xs#atW)}</span><span class='hs-varid'>xs</span></a> 
<span class=hs-linenum>106: </span>                  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_2413[VV#2412:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][VV#2417:=lq_anf__dDt][y:=x#atV][ys:=xs#atW] &amp;&amp; (VV == x#atV)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2490 : a | k_2491}
-&gt; ys:[{VV#2490 : a&lt;p y&gt; | k_2491}]&lt;p&gt;
-&gt; {VV : [{VV#2490 : a | k_2491}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a> <a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
y#atT:{VV#2410 : a | k_2411}
-&gt; ds_dBn:{VV#2417 : [{VV#2412 : a | k_2413}]&lt;\lq_tmp_x2414 VV -&gt; k_2416&gt; | k_2418}
-&gt; {VV#2424 : [{VV#2419 : a | k_2420}]&lt;\lq_tmp_x2421 VV -&gt; k_2423&gt; | k_2425}</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_2411[VV#2410:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5] &amp;&amp; (VV == y#atT)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{VV#2467 : [{VV : a | k_2413[VV#2412:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][VV#2417:=lq_anf__dDt][y:=x#atV][ys:=xs#atW] &amp;&amp; k_2416[VV#2415:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][lq_tmp_x2414:=x#atV][y:=x#atV][ys:=xs#atW]}]&lt;\lq_tmp_x2414 VV -&gt; k_2416[VV#2415:=VV][fix##36#dOrd#35#X5:=fix##36#dOrd#35#X5][y#atT:=y#atT][y:=x#atV][ys:=xs#atW]&gt; | ((len VV#2467) &gt;= 0) &amp;&amp; (VV#2467 == xs#atW)}</span><span class='hs-varid'>xs</span></a>
</pre>

<h2 id="mergesort">MergeSort</h2>
<pre><span class=hs-linenum>112: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>mergeSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>113: </span><span class='hs-definition'>mergeSort</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
lq_tmp_db9:[a] -&gt; [a]&lt;\fld VV -&gt; (VV &gt;= fld)&gt;</span><span class='hs-definition'>mergeSort</span></a> <span class='hs-conid'>[]</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
{VV : [{VV#2262 : a | k_2263}]&lt;p&gt; | ((len VV) == 0)}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>115: </span><span class='hs-definition'>mergeSort</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#2281 : [{VV#2275 : a | k_2276[VV:=VV#2281]}]&lt;\lq_tmp_x2279 VV -&gt; k_2278[VV#2277:=VV]&gt; | ((len VV#2281) == 0) &amp;&amp; ((len VV#2281) &gt;= 0) &amp;&amp; (VV#2281 == lq_anf__dDq)}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | (VV == x#atX)}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>116: </span><span class='hs-definition'>mergeSort</span> <span class='hs-varid'>xs</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
xs#au7:{VV#1917 : [{VV#1912 : a | k_1913}]&lt;\lq_tmp_x1914 VV -&gt; k_1916&gt; | k_1918}
-&gt; ds_dAL:{VV#1924 : [{VV#1919 : a | k_1920}]&lt;\lq_tmp_x1921 VV -&gt; k_1923&gt; | k_1925}
-&gt; {VV#1931 : [{VV#1926 : a | k_1927}]&lt;\lq_tmp_x1928 VV -&gt; k_1930&gt; | k_1932}</span><span class='hs-varid'>merge</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp_db9:[{VV#2383 : a | k_2384[_LIQUID_dummy:=fix##36#dOrd#35#axA]}]
-&gt; [{VV#2383 : a | k_2384[_LIQUID_dummy:=fix##36#dOrd#35#axA]}]&lt;\fld VV -&gt; (VV &gt;= fld)&gt;</span><span class='hs-varid'>mergeSort</span></a> <a class=annot href="#"><span class=annottext>{VV#2362 : [{VV#2357 : a | k_2358}]&lt;\lq_tmp_x2359 VV -&gt; k_2361&gt; | k_2363 &amp;&amp; ((len VV#2362) &gt;= 0) &amp;&amp; (VV#2362 == xs1#atZ)}</span><span class='hs-varid'>xs1</span></a><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp_db9:[{VV#2386 : a | k_2387[_LIQUID_dummy:=fix##36#dOrd#35#axA]}]
-&gt; [{VV#2386 : a | k_2387[_LIQUID_dummy:=fix##36#dOrd#35#axA]}]&lt;\fld VV -&gt; (VV &gt;= fld)&gt;</span><span class='hs-varid'>mergeSort</span></a> <a class=annot href="#"><span class=annottext>{VV#2375 : [{VV#2370 : a | k_2371}]&lt;\lq_tmp_x2372 VV -&gt; k_2374&gt; | k_2376 &amp;&amp; ((len VV#2375) &gt;= 0) &amp;&amp; (VV#2375 == xs2#au0)}</span><span class='hs-varid'>xs2</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#2362 : [{VV#2357 : a | k_2358}]&lt;\lq_tmp_x2359 VV -&gt; k_2361&gt; | k_2363}</span><span class='hs-varid'>xs1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#2375 : [{VV#2370 : a | k_2371}]&lt;\lq_tmp_x2372 VV -&gt; k_2374&gt; | k_2376}</span><span class='hs-varid'>xs2</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a.
ds_dAW:{VV#2039 : [{VV#2034 : a | k_2035}]&lt;\lq_tmp_x2036 VV -&gt; k_2038&gt; | k_2040}
-&gt; {VV#2063 : ({VV#2046 : [{VV#2041 : a | k_2042}]&lt;\lq_tmp_x2043 VV -&gt; k_2045&gt; | k_2047}, {VV#2053 : [{VV#2048 : a | k_2049}]&lt;\lq_tmp_x2050 VV -&gt; k_2052&gt; | k_2054})&lt;\lq_tmp_x2055 VV -&gt; k_2062&gt; | k_2064}</span><span class='hs-varid'>split</span></a> <a class=annot href="#"><span class=annottext>{VV#2258 : [a] | ((len VV#2258) &gt;= 0) &amp;&amp; (VV#2258 == ds_dB9)}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>117: </span>
<span class=hs-linenum>118: </span><span class='hs-definition'>split</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum>119: </span><a class=annot href="#"><span class=annottext>forall a.
ds_dAW:{VV#2039 : [{VV#2034 : a | k_2035}]&lt;\lq_tmp_x2036 VV -&gt; k_2038&gt; | k_2040}
-&gt; {VV#2063 : ({VV#2046 : [{VV#2041 : a | k_2042}]&lt;\lq_tmp_x2043 VV -&gt; k_2045&gt; | k_2047}, {VV#2053 : [{VV#2048 : a | k_2049}]&lt;\lq_tmp_x2050 VV -&gt; k_2052&gt; | k_2054})&lt;\lq_tmp_x2055 VV -&gt; k_2062&gt; | k_2064}</span><span class='hs-definition'>split</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>zs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##41#:a
-&gt; fix#x2_#40##44##41#:{VV : b&lt;p2 fix#x1_#40##44##41#&gt; | true}
-&gt; (a, b)&lt;p2&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | k_2035[VV#2034:=VV][VV#2039:=lq_anf__dDa][y:=x#au1][ys:=ds_dAX] &amp;&amp; (VV == x#au1)}</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2220 : a | k_2221}
-&gt; ys:[{VV#2220 : a&lt;p y&gt; | k_2221}]&lt;p&gt;
-&gt; {VV : [{VV#2220 : a | k_2221}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><a class=annot href="#"><span class=annottext>{VV#2199 : [{VV#2194 : a | k_2195}]&lt;\lq_tmp_x2196 VV -&gt; k_2198&gt; | k_2200 &amp;&amp; ((len VV#2199) &gt;= 0) &amp;&amp; (VV#2199 == xs#au4)}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | k_2035[VV#2034:=VV][VV#2039:=lq_anf__dDa][y:=x#au1][ys:=ds_dAX][VV#2132:=lq_anf__dDb][y:=y#au2][ys:=zs#au3] &amp;&amp; k_2038[VV#2037:=VV][lq_tmp_x2036:=x#au1][y:=x#au1][ys:=ds_dAX][VV#2132:=lq_anf__dDb][y:=y#au2][ys:=zs#au3] &amp;&amp; (VV == y#au2)}</span><span class='hs-varid'>y</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2227 : a | k_2228}
-&gt; ys:[{VV#2227 : a&lt;p y&gt; | k_2228}]&lt;p&gt;
-&gt; {VV : [{VV#2227 : a | k_2228}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><a class=annot href="#"><span class=annottext>{VV#2212 : [{VV#2207 : a | k_2208}]&lt;\lq_tmp_x2209 VV -&gt; k_2211&gt; | k_2213 &amp;&amp; ((len VV#2212) &gt;= 0) &amp;&amp; (VV#2212 == ys#au5)}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#2199 : [{VV#2194 : a | k_2195}]&lt;\lq_tmp_x2196 VV -&gt; k_2198&gt; | k_2200}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#2212 : [{VV#2207 : a | k_2208}]&lt;\lq_tmp_x2209 VV -&gt; k_2211&gt; | k_2213}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a.
ds_dAW:{VV#2039 : [{VV#2034 : a | k_2035}]&lt;\lq_tmp_x2036 VV -&gt; k_2038&gt; | k_2040}
-&gt; {VV#2063 : ({VV#2046 : [{VV#2041 : a | k_2042}]&lt;\lq_tmp_x2043 VV -&gt; k_2045&gt; | k_2047}, {VV#2053 : [{VV#2048 : a | k_2049}]&lt;\lq_tmp_x2050 VV -&gt; k_2052&gt; | k_2054})&lt;\lq_tmp_x2055 VV -&gt; k_2062&gt; | k_2064}</span><span class='hs-varid'>split</span></a> <a class=annot href="#"><span class=annottext>{VV#2139 : [{VV : a | k_2035[VV#2034:=VV][VV#2039:=lq_anf__dDa][y:=x#au1][ys:=ds_dAX][VV#2132:=lq_anf__dDb][y:=y#au2][ys:=zs#au3] &amp;&amp; k_2038[VV#2037:=VV][lq_tmp_x2036:=x#au1][y:=x#au1][ys:=ds_dAX][VV#2132:=lq_anf__dDb][y:=y#au2][ys:=zs#au3] &amp;&amp; k_2038[VV#2037:=VV][y:=x#au1][ys:=ds_dAX][lq_tmp_x2036:=y#au2][y:=y#au2][ys:=zs#au3]}]&lt;\lq_tmp_x2036 VV -&gt; k_2038[VV#2037:=VV][y:=x#au1][ys:=ds_dAX][y:=y#au2][ys:=zs#au3]&gt; | ((len VV#2139) &gt;= 0) &amp;&amp; (VV#2139 == zs#au3)}</span><span class='hs-varid'>zs</span></a>
<span class=hs-linenum>120: </span><span class='hs-definition'>split</span> <span class='hs-varid'>xs</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##41#:a
-&gt; fix#x2_#40##44##41#:{VV : b&lt;p2 fix#x1_#40##44##41#&gt; | true}
-&gt; (a, b)&lt;p2&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV#2039 : [{VV : a | k_2035[VV#2034:=VV]}]&lt;\lq_tmp_x2036 VV -&gt; k_2038[VV#2037:=VV]&gt; | k_2040 &amp;&amp; ((len VV#2039) &gt;= 0) &amp;&amp; (VV#2039 == ds_dAW)}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#2102 : [{VV#2096 : a | k_2097[VV:=VV#2102]}]&lt;\lq_tmp_x2100 VV -&gt; k_2099[VV#2098:=VV]&gt; | ((len VV#2102) == 0) &amp;&amp; ((len VV#2102) &gt;= 0) &amp;&amp; (VV#2102 == lq_anf__dD9)}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span><span class='hs-definition'>merge</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>123: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
xs#au7:{VV#1917 : [{VV#1912 : a | k_1913}]&lt;\lq_tmp_x1914 VV -&gt; k_1916&gt; | k_1918}
-&gt; ds_dAL:{VV#1924 : [{VV#1919 : a | k_1920}]&lt;\lq_tmp_x1921 VV -&gt; k_1923&gt; | k_1925}
-&gt; {VV#1931 : [{VV#1926 : a | k_1927}]&lt;\lq_tmp_x1928 VV -&gt; k_1930&gt; | k_1932}</span><span class='hs-definition'>merge</span></a> <a class=annot href="#"><span class=annottext>{VV#1917 : [{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn]}]&lt;\lq_tmp_x1914 VV -&gt; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn]&gt; | k_1918[fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn]}</span><span class='hs-varid'>xs</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#1917 : [{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn]}]&lt;\lq_tmp_x1914 VV -&gt; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn]&gt; | k_1918[fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn] &amp;&amp; ((len VV#1917) &gt;= 0) &amp;&amp; (VV#1917 == xs#au7)}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>124: </span><span class='hs-definition'>merge</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#1924 : [{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7]}]&lt;\lq_tmp_x1921 VV -&gt; k_1923[VV#1922:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7]&gt; | k_1925[fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7] &amp;&amp; ((len VV#1924) &gt;= 0) &amp;&amp; (VV#1924 == ds_dAL)}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum>125: </span><span class='hs-definition'>merge</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][VV#1917:=lq_anf__dCZ][y:=x#au9][ys:=xs#aua] &amp;&amp; (VV == x#au9)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x:{VV#1982 : a | k_1983[_LIQUID_dummy:=fix##36#dOrd#35#axn]}
-&gt; y:{VV#1982 : a | k_1983[_LIQUID_dummy:=fix##36#dOrd#35#axn]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &lt;= y))}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][VV#1924:=lq_anf__dD0][y:=y#aub][ys:=ys#auc] &amp;&amp; (VV == y#aub)}</span><span class='hs-varid'>y</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][VV#1917:=lq_anf__dCZ][y:=x#au9][ys:=xs#aua] &amp;&amp; (VV == x#au9)}</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2028 : a | k_2029}
-&gt; ys:[{VV#2028 : a&lt;p y&gt; | k_2029}]&lt;p&gt;
-&gt; {VV : [{VV#2028 : a | k_2029}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
xs#au7:{VV#1917 : [{VV#1912 : a | k_1913}]&lt;\lq_tmp_x1914 VV -&gt; k_1916&gt; | k_1918}
-&gt; ds_dAL:{VV#1924 : [{VV#1919 : a | k_1920}]&lt;\lq_tmp_x1921 VV -&gt; k_1923&gt; | k_1925}
-&gt; {VV#1931 : [{VV#1926 : a | k_1927}]&lt;\lq_tmp_x1928 VV -&gt; k_1930&gt; | k_1932}</span><span class='hs-varid'>merge</span></a> <a class=annot href="#"><span class=annottext>{VV#1961 : [{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][VV#1917:=lq_anf__dCZ][y:=x#au9][ys:=xs#aua] &amp;&amp; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][lq_tmp_x1914:=x#au9][y:=x#au9][ys:=xs#aua]}]&lt;\lq_tmp_x1914 VV -&gt; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][y:=x#au9][ys:=xs#aua]&gt; | ((len VV#1961) &gt;= 0) &amp;&amp; (VV#1961 == xs#aua)}</span><span class='hs-varid'>xs</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][VV#1924:=lq_anf__dD0][y:=y#aub][ys:=ys#auc] &amp;&amp; (VV == y#aub)}</span><span class='hs-varid'>y</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2018 : a | k_2019}
-&gt; ys:[{VV#2018 : a&lt;p y&gt; | k_2019}]&lt;p&gt;
-&gt; {VV : [{VV#2018 : a | k_2019}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><a class=annot href="#"><span class=annottext>{VV#1980 : [{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][VV#1924:=lq_anf__dD0][y:=y#aub][ys:=ys#auc] &amp;&amp; k_1923[VV#1922:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][lq_tmp_x1921:=y#aub][y:=y#aub][ys:=ys#auc]}]&lt;\lq_tmp_x1921 VV -&gt; k_1923[VV#1922:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][y:=y#aub][ys:=ys#auc]&gt; | ((len VV#1980) &gt;= 0) &amp;&amp; (VV#1980 == ys#auc)}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>126: </span>                    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][VV#1924:=lq_anf__dD0][y:=y#aub][ys:=ys#auc] &amp;&amp; (VV == y#aub)}</span><span class='hs-varid'>y</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2010 : a | k_2011}
-&gt; ys:[{VV#2010 : a&lt;p y&gt; | k_2011}]&lt;p&gt;
-&gt; {VV : [{VV#2010 : a | k_2011}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
xs#au7:{VV#1917 : [{VV#1912 : a | k_1913}]&lt;\lq_tmp_x1914 VV -&gt; k_1916&gt; | k_1918}
-&gt; ds_dAL:{VV#1924 : [{VV#1919 : a | k_1920}]&lt;\lq_tmp_x1921 VV -&gt; k_1923&gt; | k_1925}
-&gt; {VV#1931 : [{VV#1926 : a | k_1927}]&lt;\lq_tmp_x1928 VV -&gt; k_1930&gt; | k_1932}</span><span class='hs-varid'>merge</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][VV#1917:=lq_anf__dCZ][y:=x#au9][ys:=xs#aua] &amp;&amp; (VV == x#au9)}</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#2000 : a | k_2001}
-&gt; ys:[{VV#2000 : a&lt;p y&gt; | k_2001}]&lt;p&gt;
-&gt; {VV : [{VV#2000 : a | k_2001}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a><a class=annot href="#"><span class=annottext>{VV#1961 : [{VV : a | k_1913[VV#1912:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][VV#1917:=lq_anf__dCZ][y:=x#au9][ys:=xs#aua] &amp;&amp; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][lq_tmp_x1914:=x#au9][y:=x#au9][ys:=xs#aua]}]&lt;\lq_tmp_x1914 VV -&gt; k_1916[VV#1915:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][y:=x#au9][ys:=xs#aua]&gt; | ((len VV#1961) &gt;= 0) &amp;&amp; (VV#1961 == xs#aua)}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV#1980 : [{VV : a | k_1920[VV#1919:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][VV#1924:=lq_anf__dD0][y:=y#aub][ys:=ys#auc] &amp;&amp; k_1923[VV#1922:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][lq_tmp_x1921:=y#aub][y:=y#aub][ys:=ys#auc]}]&lt;\lq_tmp_x1921 VV -&gt; k_1923[VV#1922:=VV][fix##36#dOrd#35#axn:=fix##36#dOrd#35#axn][xs#au7:=xs#au7][y:=y#aub][ys:=ys#auc]&gt; | ((len VV#1980) &gt;= 0) &amp;&amp; (VV#1980 == ys#auc)}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span>
</pre>

<h2 id="quicksort">QuickSort</h2>
<pre><span class=hs-linenum>132: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>quickSort</span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>133: </span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
ds_dAA:{VV#1771 : [{VV#1766 : a | k_1767}]&lt;\lq_tmp_x1768 VV -&gt; k_1770&gt; | k_1772}
-&gt; {VV#1778 : [{VV#1773 : a | k_1774}]&lt;\lq_tmp_x1775 VV -&gt; k_1777&gt; | k_1779}</span><span class='hs-definition'>quickSort</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
{VV : [{VV#1802 : a | k_1803}]&lt;p&gt; | ((len VV) == 0)}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>134: </span><span class='hs-definition'>quickSort</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x1660:{VV#1908 : a | k_1909 &amp;&amp; k_1662[VV#1661:=VV#1908]}
-&gt; lq_tmp_x1663:{VV#1669 : [{VV#1908 : a | k_1909 &amp;&amp; k_1665[VV#1664:=VV#1908]}]&lt;\lq_tmp_x1666 VV -&gt; k_1668[VV#1667:=VV]&gt; | k_1670}
-&gt; lq_tmp_x1671:{VV#1677 : [{VV#1908 : a | k_1909 &amp;&amp; k_1673[VV#1672:=VV#1908]}]&lt;\lq_tmp_x1674 VV -&gt; k_1676[VV#1675:=VV]&gt; | k_1678}
-&gt; {VV#1684 : [{VV#1908 : a | k_1909 &amp;&amp; k_1680[VV#1679:=VV#1908]}]&lt;\lq_tmp_x1681 VV -&gt; k_1683[VV#1682:=VV]&gt; | k_1685}</span><span class='hs-varid'>append</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1767[VV#1766:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][VV#1771:=lq_anf__dCN][y:=x#aud][ys:=xs#aue] &amp;&amp; (VV == x#aud)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1778 : [{VV#1905 : a | k_1906[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX] &amp;&amp; k_1774[VV#1773:=VV#1905][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX]}]&lt;\lq_tmp_x1775 VV -&gt; k_1777[VV#1776:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX]&gt; | k_1779[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX] &amp;&amp; ((len VV#1778) &gt;= 0) &amp;&amp; (VV#1778 == lts#auf)}</span><span class='hs-varid'>lts</span></a> <a class=annot href="#"><span class=annottext>{VV#1778 : [{VV#1857 : a | k_1858[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS] &amp;&amp; k_1774[VV#1773:=VV#1857][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS]}]&lt;\lq_tmp_x1775 VV -&gt; k_1777[VV#1776:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS]&gt; | k_1779[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS] &amp;&amp; ((len VV#1778) &gt;= 0) &amp;&amp; (VV#1778 == gts#aug)}</span><span class='hs-varid'>gts</span></a> 
<span class=hs-linenum>135: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>{VV#1778 : [{VV#1905 : a | k_1906[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX] &amp;&amp; k_1774[VV#1773:=VV#1905][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX]}]&lt;\lq_tmp_x1775 VV -&gt; k_1777[VV#1776:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX]&gt; | k_1779[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCX]}</span><span class='hs-varid'>lts</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
ds_dAA:{VV#1771 : [{VV#1766 : a | k_1767}]&lt;\lq_tmp_x1768 VV -&gt; k_1770&gt; | k_1772}
-&gt; {VV#1778 : [{VV#1773 : a | k_1774}]&lt;\lq_tmp_x1775 VV -&gt; k_1777&gt; | k_1779}</span><span class='hs-varid'>quickSort</span></a> <a class=annot href="#"><span class=annottext>{VV#1872 : [{VV#1867 : a | k_1868[ds_dAD:=xs#aue]}]&lt;\lq_tmp_x1869 VV -&gt; k_1871[ds_dAD:=xs#aue]&gt; | k_1873[ds_dAD:=xs#aue] &amp;&amp; ((len VV#1872) &gt;= 0) &amp;&amp; (VV#1872 == lq_anf__dCX)}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV#1860 : a | k_1861[VV#1865:=lq_anf__dCT][y:=ds_dAE][ys:=ds_dAF] &amp;&amp; (VV#1860 == ds_dAE)}</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{VV#1810 : [{VV : a | k_1767[VV#1766:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][VV#1771:=lq_anf__dCN][y:=x#aud][ys:=xs#aue] &amp;&amp; k_1770[VV#1769:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][lq_tmp_x1768:=x#aud][y:=x#aud][ys:=xs#aue]}]&lt;\lq_tmp_x1768 VV -&gt; k_1770[VV#1769:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][y:=x#aud][ys:=xs#aue]&gt; | ((len VV#1810) &gt;= 0) &amp;&amp; (VV#1810 == xs#aue)}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1860 : a | k_1861[VV#1865:=lq_anf__dCT][y:=ds_dAE][ys:=ds_dAF] &amp;&amp; (VV#1860 == ds_dAE)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>x:{VV#1889 : a | k_1890[_LIQUID_dummy:=fix##36#dOrd#35#X3]}
-&gt; y:{VV#1889 : a | k_1890[_LIQUID_dummy:=fix##36#dOrd#35#X3]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &lt; y))}</span><span class='hs-varop'>&lt;</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1767[VV#1766:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][VV#1771:=lq_anf__dCN][y:=x#aud][ys:=xs#aue] &amp;&amp; (VV == x#aud)}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>136: </span>        <a class=annot href="#"><span class=annottext>{VV#1778 : [{VV#1857 : a | k_1858[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS] &amp;&amp; k_1774[VV#1773:=VV#1857][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS]}]&lt;\lq_tmp_x1775 VV -&gt; k_1777[VV#1776:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS]&gt; | k_1779[fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][ds_dAA:=lq_anf__dCS]}</span><span class='hs-varid'>gts</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Ord a) =&gt;
ds_dAA:{VV#1771 : [{VV#1766 : a | k_1767}]&lt;\lq_tmp_x1768 VV -&gt; k_1770&gt; | k_1772}
-&gt; {VV#1778 : [{VV#1773 : a | k_1774}]&lt;\lq_tmp_x1775 VV -&gt; k_1777&gt; | k_1779}</span><span class='hs-varid'>quickSort</span></a> <a class=annot href="#"><span class=annottext>{VV#1824 : [{VV#1819 : a | k_1820[ds_dAH:=xs#aue]}]&lt;\lq_tmp_x1821 VV -&gt; k_1823[ds_dAH:=xs#aue]&gt; | k_1825[ds_dAH:=xs#aue] &amp;&amp; ((len VV#1824) &gt;= 0) &amp;&amp; (VV#1824 == lq_anf__dCS)}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV#1812 : a | k_1813[VV#1817:=lq_anf__dCO][y:=ds_dAI][ys:=ds_dAJ] &amp;&amp; (VV#1812 == ds_dAI)}</span><span class='hs-varid'>z</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>z</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{VV#1810 : [{VV : a | k_1767[VV#1766:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][VV#1771:=lq_anf__dCN][y:=x#aud][ys:=xs#aue] &amp;&amp; k_1770[VV#1769:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][lq_tmp_x1768:=x#aud][y:=x#aud][ys:=xs#aue]}]&lt;\lq_tmp_x1768 VV -&gt; k_1770[VV#1769:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][y:=x#aud][ys:=xs#aue]&gt; | ((len VV#1810) &gt;= 0) &amp;&amp; (VV#1810 == xs#aue)}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1812 : a | k_1813[VV#1817:=lq_anf__dCO][y:=ds_dAI][ys:=ds_dAJ] &amp;&amp; (VV#1812 == ds_dAI)}</span><span class='hs-varid'>z</span></a> <a class=annot href="#"><span class=annottext>x:{VV#1841 : a | k_1842[_LIQUID_dummy:=fix##36#dOrd#35#X3]}
-&gt; y:{VV#1841 : a | k_1842[_LIQUID_dummy:=fix##36#dOrd#35#X3]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &gt;= y))}</span><span class='hs-varop'>&gt;=</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1767[VV#1766:=VV][fix##36#dOrd#35#X3:=fix##36#dOrd#35#X3][VV#1771:=lq_anf__dCN][y:=x#aud][ys:=xs#aue] &amp;&amp; (VV == x#aud)}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span><a class=annot href="#"><span class=annottext>forall a.
k#auj:{VV#1686 : a | k_1687}
-&gt; ds_dAx:{VV#1693 : [{VV#1688 : a | k_1689}]&lt;\lq_tmp_x1690 VV -&gt; k_1692&gt; | k_1694}
-&gt; ys#auk:{VV#1700 : [{VV#1695 : a | k_1696}]&lt;\lq_tmp_x1697 VV -&gt; k_1699&gt; | k_1701}
-&gt; {VV#1707 : [{VV#1702 : a | k_1703}]&lt;\lq_tmp_x1704 VV -&gt; k_1706&gt; | k_1708}</span><span class='hs-definition'>append</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1687[VV#1686:=VV]}</span><span class='hs-varid'>k</span></a> <span class='hs-conid'>[]</span>     <a class=annot href="#"><span class=annottext>{VV#1700 : [{VV : a | k_1696[VV#1695:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]}]&lt;\lq_tmp_x1697 VV -&gt; k_1699[VV#1698:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]&gt; | k_1701[k#auj:=k#auj][ds_dAx:=ds_dAx]}</span><span class='hs-varid'>ys</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_1687[VV#1686:=VV] &amp;&amp; (VV == k#auj)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#1743 : a | k_1744}
-&gt; ys:[{VV#1743 : a&lt;p y&gt; | k_1744}]&lt;p&gt;
-&gt; {VV : [{VV#1743 : a | k_1744}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a> <a class=annot href="#"><span class=annottext>{VV#1700 : [{VV : a | k_1696[VV#1695:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]}]&lt;\lq_tmp_x1697 VV -&gt; k_1699[VV#1698:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]&gt; | k_1701[k#auj:=k#auj][ds_dAx:=ds_dAx] &amp;&amp; ((len VV#1700) &gt;= 0) &amp;&amp; (VV#1700 == ys#auk)}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum>139: </span><span class='hs-definition'>append</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>ys</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | k_1689[VV#1688:=VV][k#auj:=k#auj][VV#1693:=lq_anf__dCL][y:=x#aum][ys:=xs#aun] &amp;&amp; (VV == x#aum)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall &lt;p :: a-&gt; a-&gt; Bool&gt;.
y:{VV#1756 : a | k_1757}
-&gt; ys:[{VV#1756 : a&lt;p y&gt; | k_1757}]&lt;p&gt;
-&gt; {VV : [{VV#1756 : a | k_1757}]&lt;p&gt; | ((len VV) == (1 + (len ys)))}</span><span class='hs-conop'>:</span></a> <a class=annot href="#"><span class=annottext>forall a.
k#auj:{VV#1686 : a | k_1687}
-&gt; ds_dAx:{VV#1693 : [{VV#1688 : a | k_1689}]&lt;\lq_tmp_x1690 VV -&gt; k_1692&gt; | k_1694}
-&gt; ys#auk:{VV#1700 : [{VV#1695 : a | k_1696}]&lt;\lq_tmp_x1697 VV -&gt; k_1699&gt; | k_1701}
-&gt; {VV#1707 : [{VV#1702 : a | k_1703}]&lt;\lq_tmp_x1704 VV -&gt; k_1706&gt; | k_1708}</span><span class='hs-varid'>append</span></a> <a class=annot href="#"><span class=annottext>{VV : a | k_1687[VV#1686:=VV] &amp;&amp; (VV == k#auj)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#1751 : [{VV : a | k_1689[VV#1688:=VV][k#auj:=k#auj][VV#1693:=lq_anf__dCL][y:=x#aum][ys:=xs#aun] &amp;&amp; k_1692[VV#1691:=VV][k#auj:=k#auj][lq_tmp_x1690:=x#aum][y:=x#aum][ys:=xs#aun]}]&lt;\lq_tmp_x1690 VV -&gt; k_1692[VV#1691:=VV][k#auj:=k#auj][y:=x#aum][ys:=xs#aun]&gt; | ((len VV#1751) &gt;= 0) &amp;&amp; (VV#1751 == xs#aun)}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{VV#1700 : [{VV : a | k_1696[VV#1695:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]}]&lt;\lq_tmp_x1697 VV -&gt; k_1699[VV#1698:=VV][k#auj:=k#auj][ds_dAx:=ds_dAx]&gt; | k_1701[k#auj:=k#auj][ds_dAx:=ds_dAx] &amp;&amp; ((len VV#1700) &gt;= 0) &amp;&amp; (VV#1700 == ys#auk)}</span><span class='hs-varid'>ys</span></a>
</pre>


<h1 id="maps">Maps</h1>
<p><a href="http://goto.ucsd.edu/~rjhala/liquid/haskell/demo/#?demo=Map.hs">Demo</a></p>
<p>As another application of recursive refinements, consinder a Map from keys of type <code>k</code> to values of type <code>a</code> implemented as a binary tree:</p>
<pre><span class=hs-linenum>152: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tip</span>
<span class=hs-linenum>153: </span>             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Bin</span> <span class='hs-conid'>Size</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>154: </span>
<span class=hs-linenum>155: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Size</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
</pre>

<p>We abstract from the structure two refinements <code>l</code> and <code>r</code> to describe the values of the left and right subtree with respect to the current key:</p>
<pre><span class=hs-linenum>163: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>164: </span>  <span class='hs-keyword'>data</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>l</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>root</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prop</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>root</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prop</span><span class='hs-varop'>&gt;</span>
<span class=hs-linenum>165: </span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tip</span>
<span class=hs-linenum>166: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Bin</span> <span class='hs-layout'>(</span><span class='hs-varid'>sz</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Size</span><span class='hs-layout'>)</span>
<span class=hs-linenum>167: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>key</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span>
<span class=hs-linenum>168: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>value</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>169: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>left</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Map</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>l</span> <span class='hs-varid'>key</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>170: </span>            <span class='hs-layout'>(</span><span class='hs-varid'>right</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Map</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span> <span class='hs-varop'>&lt;</span><span class='hs-varid'>r</span> <span class='hs-varid'>key</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>171: </span>  <span class='hs-keyword'>@-}</span>
</pre>

<p>Thus, if we instantiate the refinements with the following predicates</p>
<pre><span class=hs-linenum>177: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span> <span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>r</span> <span class='hs-layout'>}</span><span class='hs-layout'>,</span> <span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>r</span> <span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>178: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>MinHeap</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span> <span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span><span class='hs-layout'>,</span> <span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>179: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>MaxHeap</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span> <span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span><span class='hs-layout'>,</span> <span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
</pre>

<p>then <code>BST k v</code>, <code>MinHeap k v</code> and <code>MaxHeap k v</code> denote exactly binary-search-ordered, min-heap-ordered, and max-heap-ordered trees (with keys and values of types <code>k</code> and <code>v</code>).</p>
<p>We can use the above types to automatically verify that the following functions preserve BST.</p>
<h2 id="empty">Empty</h2>
<pre><span class=hs-linenum>189: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>190: </span><span class='hs-definition'>empty</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>191: </span><a class=annot href="#"><span class=annottext>forall k a. (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)</span><span class='hs-definition'>empty</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall &lt;r :: k-&gt; k-&gt; Bool, l :: k-&gt; k-&gt; Bool&gt;.
(List.Map &lt;l, r&gt; {VV#1648 : k | k_1649} {VV#1650 : a | k_1651})</span><span class='hs-conid'>Tip</span></a>
</pre>

<h2 id="insert">Insert</h2>
<pre><span class=hs-linenum>197: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insertBST</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>198: </span><span class='hs-definition'>insertBST</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>199: </span><a class=annot href="#"><span class=annottext>forall k a.
(GHC.Classes.Ord k) =&gt;
k:k
-&gt; a:a
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)</span><span class='hs-definition'>insertBST</span></a> <a class=annot href="#"><span class=annottext>k</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>200: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV#1593 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a) | (VV#1593 == t#aur)}</span><span class='hs-varid'>t</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>201: </span>     <span class='hs-conid'>Tip</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#auD:{VV#1597 : k | k_1598 &amp;&amp; k_1476[VV#1475:=VV#1597]}
-&gt; x#auE:{VV#1599 : a | k_1600 &amp;&amp; k_1479[VV#1478:=VV#1599]}
-&gt; {VV#1491 : (List.Map &lt;\lq_tmp_x1485 VV -&gt; k_1487[VV#1486:=VV], \lq_tmp_x1488 VV -&gt; k_1490[VV#1489:=VV]&gt; {VV#1597 : k | k_1598 &amp;&amp; k_1482[VV#1481:=VV#1597]} {VV#1599 : a | k_1600 &amp;&amp; k_1484[VV#1483:=VV#1599]}) | k_1492}</span><span class='hs-varid'>singleton</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#aup)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auq)}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>202: </span>     <span class='hs-conid'>Bin</span> <span class='hs-varid'>sz</span> <span class='hs-varid'>ky</span> <span class='hs-varid'>y</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>203: </span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>x:{VV#1608 : k | k_1609[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; y:{VV#1608 : k | k_1609[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; {VV : (GHC.Types.Ordering) | ((VV == EQ#6U) &lt;=&gt; (x == y)) &amp;&amp; ((VV == LT#6S) &lt;=&gt; (x &lt; y)) &amp;&amp; ((VV == GT#6W) &lt;=&gt; (x &gt; y))}</span><span class='hs-varid'>compare</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#aup)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == ky#aut)}</span><span class='hs-varid'>ky</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>204: </span>              <span class='hs-conid'>LT</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1619 : k | k_1620 &amp;&amp; k_140[VV#139:=VV#1619]}
-&gt; x#avh:{VV#1621 : a | k_1622 &amp;&amp; k_143[VV#142:=VV#1621]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1619 : k | k_1620 &amp;&amp; k_146[VV#145:=VV#1619]} {VV#1621 : a | k_1622 &amp;&amp; k_148[VV#147:=VV#1621]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1619 : k | k_1620 &amp;&amp; k_159[VV#158:=VV#1619]} {VV#1621 : a | k_1622 &amp;&amp; k_161[VV#160:=VV#1621]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1619 : k | k_1620 &amp;&amp; k_172[VV#171:=VV#1619]} {VV#1621 : a | k_1622 &amp;&amp; k_174[VV#173:=VV#1621]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == ky#aut)}</span><span class='hs-varid'>ky</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#auu)}</span><span class='hs-varid'>y</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k:{VV#1614 : k | k_1615[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; a:{VV#1616 : a | k_1617[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1614 : k | k_1615[_LIQUID_dummy:=fix##36#dOrd#35#awH]} {VV#1616 : a | k_1617[_LIQUID_dummy:=fix##36#dOrd#35#awH]})
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1614 : k | k_1615[_LIQUID_dummy:=fix##36#dOrd#35#awH]} {VV#1616 : a | k_1617[_LIQUID_dummy:=fix##36#dOrd#35#awH]})</span><span class='hs-varid'>insertBST</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#aup)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auq)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1605 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; ky#aut)} a) | (VV#1605 == l#auv)}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV#1606 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; ky#aut)} a) | (VV#1606 == r#auw)}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>205: </span>              <span class='hs-conid'>GT</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1644 : k | k_1645 &amp;&amp; k_140[VV#139:=VV#1644]}
-&gt; x#avh:{VV#1646 : a | k_1647 &amp;&amp; k_143[VV#142:=VV#1646]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1644 : k | k_1645 &amp;&amp; k_146[VV#145:=VV#1644]} {VV#1646 : a | k_1647 &amp;&amp; k_148[VV#147:=VV#1646]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1644 : k | k_1645 &amp;&amp; k_159[VV#158:=VV#1644]} {VV#1646 : a | k_1647 &amp;&amp; k_161[VV#160:=VV#1646]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1644 : k | k_1645 &amp;&amp; k_172[VV#171:=VV#1644]} {VV#1646 : a | k_1647 &amp;&amp; k_174[VV#173:=VV#1646]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == ky#aut)}</span><span class='hs-varid'>ky</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == y#auu)}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{VV#1605 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; ky#aut)} a) | (VV#1605 == l#auv)}</span><span class='hs-varid'>l</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k:{VV#1639 : k | k_1640[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; a:{VV#1641 : a | k_1642[_LIQUID_dummy:=fix##36#dOrd#35#awH]}
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1639 : k | k_1640[_LIQUID_dummy:=fix##36#dOrd#35#awH]} {VV#1641 : a | k_1642[_LIQUID_dummy:=fix##36#dOrd#35#awH]})
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1639 : k | k_1640[_LIQUID_dummy:=fix##36#dOrd#35#awH]} {VV#1641 : a | k_1642[_LIQUID_dummy:=fix##36#dOrd#35#awH]})</span><span class='hs-varid'>insertBST</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#aup)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auq)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1606 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; ky#aut)} a) | (VV#1606 == r#auw)}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>206: </span>              <span class='hs-conid'>EQ</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall &lt;r :: k-&gt; k-&gt; Bool, l :: k-&gt; k-&gt; Bool&gt;.
sz_List.Bin:(GHC.Types.Int)
-&gt; key_List.Bin:{VV#1625 : k | k_1626}
-&gt; value_List.Bin:{VV#1627 : a | k_1628}
-&gt; left_List.Bin:(List.Map &lt;l, r&gt; {VV#1625 : k&lt;l key_List.Bin&gt; | k_1626} {VV#1627 : a | k_1628})
-&gt; right_List.Bin:(List.Map &lt;l, r&gt; {VV#1625 : k&lt;r key_List.Bin&gt; | k_1626} {VV#1627 : a | k_1628})
-&gt; (List.Map &lt;l, r&gt; {VV#1625 : k | k_1626} {VV#1627 : a | k_1628})</span><span class='hs-conid'>Bin</span></a> <a class=annot href="#"><span class=annottext>{VV#1602 : (GHC.Types.Int) | (VV#1602 == sz#aus)}</span><span class='hs-varid'>sz</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#aup)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auq)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1605 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; ky#aut)} a) | (VV#1605 == l#auv)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#1606 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; ky#aut)} a) | (VV#1606 == r#auw)}</span><span class='hs-varid'>r</span></a>
</pre>

<h2 id="delete">Delete</h2>
<pre><span class=hs-linenum>213: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>delete</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-conop'>:</span><span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BST</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>214: </span><span class='hs-definition'>delete</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>215: </span><a class=annot href="#"><span class=annottext>forall k a.
(GHC.Classes.Ord k) =&gt;
k:k
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)</span><span class='hs-definition'>delete</span></a> <a class=annot href="#"><span class=annottext>k</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a)</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>216: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV#1535 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; k a) | (VV#1535 == t#auy)}</span><span class='hs-varid'>t</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>217: </span>      <span class='hs-conid'>Tip</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall &lt;r :: k-&gt; k-&gt; Bool, l :: k-&gt; k-&gt; Bool&gt;.
(List.Map &lt;l, r&gt; {VV#1539 : k | k_1540} {VV#1541 : a | k_1542})</span><span class='hs-conid'>Tip</span></a>
<span class=hs-linenum>218: </span>      <span class='hs-conid'>Bin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>kx</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>219: </span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>x:{VV#1558 : k | k_1559[_LIQUID_dummy:=fix##36#dOrd#35#awB]}
-&gt; y:{VV#1558 : k | k_1559[_LIQUID_dummy:=fix##36#dOrd#35#awB]}
-&gt; {VV : (GHC.Types.Ordering) | ((VV == EQ#6U) &lt;=&gt; (x == y)) &amp;&amp; ((VV == LT#6S) &lt;=&gt; (x &lt; y)) &amp;&amp; ((VV == GT#6W) &lt;=&gt; (x &gt; y))}</span><span class='hs-varid'>compare</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == k#aux)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#auz)}</span><span class='hs-varid'>kx</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>220: </span>               <span class='hs-conid'>LT</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1569 : k | k_1570 &amp;&amp; k_140[VV#139:=VV#1569]}
-&gt; x#avh:{VV#1571 : a | k_1572 &amp;&amp; k_143[VV#142:=VV#1571]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1569 : k | k_1570 &amp;&amp; k_146[VV#145:=VV#1569]} {VV#1571 : a | k_1572 &amp;&amp; k_148[VV#147:=VV#1571]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1569 : k | k_1570 &amp;&amp; k_159[VV#158:=VV#1569]} {VV#1571 : a | k_1572 &amp;&amp; k_161[VV#160:=VV#1571]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1569 : k | k_1570 &amp;&amp; k_172[VV#171:=VV#1569]} {VV#1571 : a | k_1572 &amp;&amp; k_174[VV#173:=VV#1571]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#auz)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auA)}</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k:{VV#1564 : k | k_1565[_LIQUID_dummy:=fix##36#dOrd#35#awB]}
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1564 : k | k_1565[_LIQUID_dummy:=fix##36#dOrd#35#awB]} {VV#1566 : a | k_1567[_LIQUID_dummy:=fix##36#dOrd#35#awB]})
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1564 : k | k_1565[_LIQUID_dummy:=fix##36#dOrd#35#awB]} {VV#1566 : a | k_1567[_LIQUID_dummy:=fix##36#dOrd#35#awB]})</span><span class='hs-varid'>delete</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == k#aux)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#1555 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; kx#auz)} a) | (VV#1555 == l#auB)}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV#1556 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; kx#auz)} a) | (VV#1556 == r#auC)}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>221: </span>               <span class='hs-conid'>GT</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1586 : k | k_1587 &amp;&amp; k_140[VV#139:=VV#1586]}
-&gt; x#avh:{VV#1588 : a | k_1589 &amp;&amp; k_143[VV#142:=VV#1588]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1586 : k | k_1587 &amp;&amp; k_146[VV#145:=VV#1586]} {VV#1588 : a | k_1589 &amp;&amp; k_148[VV#147:=VV#1588]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1586 : k | k_1587 &amp;&amp; k_159[VV#158:=VV#1586]} {VV#1588 : a | k_1589 &amp;&amp; k_161[VV#160:=VV#1588]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1586 : k | k_1587 &amp;&amp; k_172[VV#171:=VV#1586]} {VV#1588 : a | k_1589 &amp;&amp; k_174[VV#173:=VV#1588]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#auz)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#auA)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1555 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; kx#auz)} a) | (VV#1555 == l#auB)}</span><span class='hs-varid'>l</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k:{VV#1581 : k | k_1582[_LIQUID_dummy:=fix##36#dOrd#35#awB]}
-&gt; t:(List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1581 : k | k_1582[_LIQUID_dummy:=fix##36#dOrd#35#awB]} {VV#1583 : a | k_1584[_LIQUID_dummy:=fix##36#dOrd#35#awB]})
-&gt; (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV#1581 : k | k_1582[_LIQUID_dummy:=fix##36#dOrd#35#awB]} {VV#1583 : a | k_1584[_LIQUID_dummy:=fix##36#dOrd#35#awB]})</span><span class='hs-varid'>delete</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == k#aux)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#1556 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; kx#auz)} a) | (VV#1556 == r#auC)}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>222: </span>               <span class='hs-conid'>EQ</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>k#auF:{VV#1575 : k | k_1576 &amp;&amp; k_1105[VV#1104:=VV#1575]}
-&gt; ds_dA9:{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113[VV#1112:=VV], \lq_tmp_x1114 VV -&gt; k_1116[VV#1115:=VV]&gt; {VV#1575 : k | k_1576 &amp;&amp; k_1108[VV#1107:=VV#1575]} {VV#1577 : a | k_1578 &amp;&amp; k_1110[VV#1109:=VV#1577]}) | k_1118}
-&gt; r#auG:{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126[VV#1125:=VV], \lq_tmp_x1127 VV -&gt; k_1129[VV#1128:=VV]&gt; {VV#1575 : k | k_1576 &amp;&amp; k_1121[VV#1120:=VV#1575]} {VV#1577 : a | k_1578 &amp;&amp; k_1123[VV#1122:=VV#1577]}) | k_1131}
-&gt; {VV#1143 : (List.Map &lt;\lq_tmp_x1137 VV -&gt; k_1139[VV#1138:=VV], \lq_tmp_x1140 VV -&gt; k_1142[VV#1141:=VV]&gt; {VV#1575 : k | k_1576 &amp;&amp; k_1134[VV#1133:=VV#1575]} {VV#1577 : a | k_1578 &amp;&amp; k_1136[VV#1135:=VV#1577]}) | k_1144}</span><span class='hs-varid'>glue</span></a> <a class=annot href="#"><span class=annottext>{VV : k | (VV == kx#auz)}</span><span class='hs-varid'>kx</span></a> <a class=annot href="#"><span class=annottext>{VV#1555 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &lt; kx#auz)} a) | (VV#1555 == l#auB)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#1556 : (List.Map &lt;\r VV -&gt; (VV &lt; r), \r VV -&gt; (VV &gt; r)&gt; {VV : k | (VV &gt; kx#auz)} a) | (VV#1556 == r#auC)}</span><span class='hs-varid'>r</span></a>
</pre>

<p>Below are the functions used by <code>insert</code> and <code>delete</code>:</p>
<pre><span class=hs-linenum>227: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>228: </span><a class=annot href="#"><span class=annottext>forall k a.
k#auD:{VV#1475 : k | k_1476}
-&gt; x#auE:{VV#1478 : a | k_1479}
-&gt; {VV#1491 : (List.Map &lt;\lq_tmp_x1485 VV -&gt; k_1487, \lq_tmp_x1488 VV -&gt; k_1490&gt; {VV#1481 : k | k_1482} {VV#1483 : a | k_1484}) | k_1492}</span><span class='hs-definition'>singleton</span></a> <a class=annot href="#"><span class=annottext>{VV#1475 : k | k_1476}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#1478 : a | k_1479}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>229: </span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall &lt;r :: k-&gt; k-&gt; Bool, l :: k-&gt; k-&gt; Bool&gt;.
sz_List.Bin:(GHC.Types.Int)
-&gt; key_List.Bin:{VV#1520 : k | k_1521}
-&gt; value_List.Bin:{VV#1522 : a | k_1523}
-&gt; left_List.Bin:(List.Map &lt;l, r&gt; {VV#1520 : k&lt;l key_List.Bin&gt; | k_1521} {VV#1522 : a | k_1523})
-&gt; right_List.Bin:(List.Map &lt;l, r&gt; {VV#1520 : k&lt;r key_List.Bin&gt; | k_1521} {VV#1522 : a | k_1523})
-&gt; (List.Map &lt;l, r&gt; {VV#1520 : k | k_1521} {VV#1522 : a | k_1523})</span><span class='hs-conid'>Bin</span></a> <a class=annot href="#"><span class=annottext>{VV#1493 : (GHC.Types.Int) | (VV#1493 == (1  :  int)) &amp;&amp; (VV#1493 == lq_anf__dCy)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>{VV#1475 : k | k_1476 &amp;&amp; (VV#1475 == k#auD)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#1478 : a | k_1479 &amp;&amp; (VV#1478 == x#auE)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1506 : (List.Map &lt;\lq_tmp_x1504 VV -&gt; k_1503[VV#1502:=VV], \lq_tmp_x1500 VV -&gt; k_1499[VV#1498:=VV]&gt; {VV#1494 : k | k_1495[VV:=VV#1506]} {VV#1496 : a | k_1497[VV:=VV#1506]}) | (VV#1506 == lq_anf__dCz)}</span><span class='hs-conid'>Tip</span></a> <a class=annot href="#"><span class=annottext>{VV#1519 : (List.Map &lt;\lq_tmp_x1517 VV -&gt; k_1516[VV#1515:=VV], \lq_tmp_x1513 VV -&gt; k_1512[VV#1511:=VV]&gt; {VV#1507 : k | k_1508[VV:=VV#1519]} {VV#1509 : a | k_1510[VV:=VV#1519]}) | (VV#1519 == lq_anf__dCA)}</span><span class='hs-conid'>Tip</span></a>
<span class=hs-linenum>230: </span>
<span class=hs-linenum>231: </span>
<span class=hs-linenum>232: </span><span class='hs-definition'>glue</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>233: </span><a class=annot href="#"><span class=annottext>forall k a.
k#auF:{VV#1104 : k | k_1105}
-&gt; ds_dA9:{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113, \lq_tmp_x1114 VV -&gt; k_1116&gt; {VV#1107 : k | k_1108} {VV#1109 : a | k_1110}) | k_1118}
-&gt; r#auG:{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131}
-&gt; {VV#1143 : (List.Map &lt;\lq_tmp_x1137 VV -&gt; k_1139, \lq_tmp_x1140 VV -&gt; k_1142&gt; {VV#1133 : k | k_1134} {VV#1135 : a | k_1136}) | k_1144}</span><span class='hs-definition'>glue</span></a> <a class=annot href="#"><span class=annottext>{VV#1104 : k | k_1105}</span><span class='hs-varid'>k</span></a> <span class='hs-conid'>Tip</span> <a class=annot href="#"><span class=annottext>{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131}</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131 &amp;&amp; (VV#1130 == r#auG)}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>234: </span><span class='hs-definition'>glue</span> <span class='hs-varid'>k</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Tip</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113, \lq_tmp_x1114 VV -&gt; k_1116&gt; {VV#1107 : k | k_1108} {VV#1109 : a | k_1110}) | k_1118 &amp;&amp; (VV#1117 == ds_dA9)}</span><span class='hs-varid'>l</span></a>
<span class=hs-linenum>235: </span><span class='hs-definition'>glue</span> <span class='hs-varid'>k</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>236: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>t#avo:{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119[VV#118:=VV], \lq_tmp_x120 VV -&gt; k_122[VV#121:=VV]&gt; {VV#1199 : k | k_1200 &amp;&amp; k_114[VV#113:=VV#1199]} {VV#1201 : a | k_1202 &amp;&amp; k_116[VV#115:=VV#1201]}) | k_124}
-&gt; {VV#126 : (GHC.Types.Int) | k_127}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113, \lq_tmp_x1114 VV -&gt; k_1116&gt; {VV#1107 : k | k_1108} {VV#1109 : a | k_1110}) | k_1118 &amp;&amp; (VV#1117 == ds_dA9)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>x:{VV#1209 : (GHC.Types.Int) | k_1210[_LIQUID_dummy:=fix##36#fOrdInt#35#rbF]}
-&gt; y:{VV#1209 : (GHC.Types.Int) | k_1210[_LIQUID_dummy:=fix##36#fOrdInt#35#rbF]}
-&gt; {VV : (GHC.Types.Bool) | (((Prop VV)) &lt;=&gt; (x &gt; y))}</span><span class='hs-varop'>&gt;</span></a> <a class=annot href="#"><span class=annottext>t#avo:{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119[VV#118:=VV], \lq_tmp_x120 VV -&gt; k_122[VV#121:=VV]&gt; {VV#1204 : k | k_1205 &amp;&amp; k_114[VV#113:=VV#1204]} {VV#1206 : a | k_1207 &amp;&amp; k_116[VV#115:=VV#1206]}) | k_124}
-&gt; {VV#126 : (GHC.Types.Int) | k_127}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131 &amp;&amp; (VV#1130 == r#auG)}</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#1433 : k | k_1434}</span><span class='hs-varid'>km1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1442 : a | k_1443}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1461 : (List.Map &lt;\lq_tmp_x1455 VV -&gt; k_1457, \lq_tmp_x1458 VV -&gt; k_1460&gt; {VV#1451 : k | k_1452} {VV#1453 : a | k_1454}) | k_1462}</span><span class='hs-varid'>lm</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x644:{VV#655 : (List.Map &lt;\lq_tmp_x649 VV -&gt; k_651[VV#650:=VV], \lq_tmp_x652 VV -&gt; k_654[VV#653:=VV]&gt; {VV#1354 : k | k_1355 &amp;&amp; k_646[VV#645:=VV#1354]} {VV#1356 : a | k_1357 &amp;&amp; k_648[VV#647:=VV#1356]}) | k_656}
-&gt; {VV#690 : ({VV#1354 : k | k_1355 &amp;&amp; k_658[VV#657:=VV#1354]}, {VV#1356 : a | k_1357 &amp;&amp; k_660[VV#659:=VV#1356]}, {VV#671 : (List.Map &lt;\lq_tmp_x665 VV -&gt; k_667[VV#666:=VV], \lq_tmp_x668 VV -&gt; k_670[VV#669:=VV]&gt; {VV#1354 : k | k_1355 &amp;&amp; k_662[VV#661:=VV#1354]} {VV#1356 : a | k_1357 &amp;&amp; k_664[VV#663:=VV#1356]}) | k_672})&lt;\lq_tmp_x673 VV -&gt; k_675[VV#674:=VV], \lq_tmp_x676 lq_tmp_x677 VV -&gt; k_689&gt; | k_691}</span><span class='hs-varid'>deleteFindMax</span></a> <a class=annot href="#"><span class=annottext>{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113, \lq_tmp_x1114 VV -&gt; k_1116&gt; {VV#1107 : k | k_1108} {VV#1109 : a | k_1110}) | k_1118 &amp;&amp; (VV#1117 == ds_dA9)}</span><span class='hs-varid'>l</span></a> <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1470 : k | k_1471 &amp;&amp; k_140[VV#139:=VV#1470]}
-&gt; x#avh:{VV#1472 : a | k_1473 &amp;&amp; k_143[VV#142:=VV#1472]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1470 : k | k_1471 &amp;&amp; k_146[VV#145:=VV#1470]} {VV#1472 : a | k_1473 &amp;&amp; k_148[VV#147:=VV#1472]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1470 : k | k_1471 &amp;&amp; k_159[VV#158:=VV#1470]} {VV#1472 : a | k_1473 &amp;&amp; k_161[VV#160:=VV#1472]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1470 : k | k_1471 &amp;&amp; k_172[VV#171:=VV#1470]} {VV#1472 : a | k_1473 &amp;&amp; k_174[VV#173:=VV#1472]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV#1433 : k | k_1434 &amp;&amp; (VV#1433 == km1#auM)}</span><span class='hs-varid'>km1</span></a> <a class=annot href="#"><span class=annottext>{VV#1442 : a | k_1443 &amp;&amp; (VV#1442 == vm#auN)}</span><span class='hs-varid'>vm</span></a> <a class=annot href="#"><span class=annottext>{VV#1461 : (List.Map &lt;\lq_tmp_x1455 VV -&gt; k_1457, \lq_tmp_x1458 VV -&gt; k_1460&gt; {VV#1451 : k | k_1452} {VV#1453 : a | k_1454}) | k_1462 &amp;&amp; (VV#1461 == lm#auO)}</span><span class='hs-varid'>lm</span></a> <a class=annot href="#"><span class=annottext>{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131 &amp;&amp; (VV#1130 == r#auG)}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>237: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>       <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#1311 : k | k_1312}</span><span class='hs-varid'>km2</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1320 : a | k_1321}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1339 : (List.Map &lt;\lq_tmp_x1333 VV -&gt; k_1335, \lq_tmp_x1336 VV -&gt; k_1338&gt; {VV#1329 : k | k_1330} {VV#1331 : a | k_1332}) | k_1340}</span><span class='hs-varid'>rm</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x184:{VV#195 : (List.Map &lt;\lq_tmp_x189 VV -&gt; k_191[VV#190:=VV], \lq_tmp_x192 VV -&gt; k_194[VV#193:=VV]&gt; {VV#1232 : k | k_1233 &amp;&amp; k_186[VV#185:=VV#1232]} {VV#1234 : a | k_1235 &amp;&amp; k_188[VV#187:=VV#1234]}) | k_196}
-&gt; {VV#230 : ({VV#1232 : k | k_1233 &amp;&amp; k_198[VV#197:=VV#1232]}, {VV#1234 : a | k_1235 &amp;&amp; k_200[VV#199:=VV#1234]}, {VV#211 : (List.Map &lt;\lq_tmp_x205 VV -&gt; k_207[VV#206:=VV], \lq_tmp_x208 VV -&gt; k_210[VV#209:=VV]&gt; {VV#1232 : k | k_1233 &amp;&amp; k_202[VV#201:=VV#1232]} {VV#1234 : a | k_1235 &amp;&amp; k_204[VV#203:=VV#1234]}) | k_212})&lt;\lq_tmp_x213 VV -&gt; k_215[VV#214:=VV], \lq_tmp_x216 lq_tmp_x217 VV -&gt; k_229&gt; | k_231}</span><span class='hs-varid'>deleteFindMin</span></a> <a class=annot href="#"><span class=annottext>{VV#1130 : (List.Map &lt;\lq_tmp_x1124 VV -&gt; k_1126, \lq_tmp_x1127 VV -&gt; k_1129&gt; {VV#1120 : k | k_1121} {VV#1122 : a | k_1123}) | k_1131 &amp;&amp; (VV#1130 == r#auG)}</span><span class='hs-varid'>r</span></a> <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>k#avg:{VV#1348 : k | k_1349 &amp;&amp; k_140[VV#139:=VV#1348]}
-&gt; x#avh:{VV#1350 : a | k_1351 &amp;&amp; k_143[VV#142:=VV#1350]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1348 : k | k_1349 &amp;&amp; k_146[VV#145:=VV#1348]} {VV#1350 : a | k_1351 &amp;&amp; k_148[VV#147:=VV#1350]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1348 : k | k_1349 &amp;&amp; k_159[VV#158:=VV#1348]} {VV#1350 : a | k_1351 &amp;&amp; k_161[VV#160:=VV#1350]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1348 : k | k_1349 &amp;&amp; k_172[VV#171:=VV#1348]} {VV#1350 : a | k_1351 &amp;&amp; k_174[VV#173:=VV#1350]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV#1311 : k | k_1312 &amp;&amp; (VV#1311 == km2#auP)}</span><span class='hs-varid'>km2</span></a> <a class=annot href="#"><span class=annottext>{VV#1320 : a | k_1321 &amp;&amp; (VV#1320 == vm#auQ)}</span><span class='hs-varid'>vm</span></a> <a class=annot href="#"><span class=annottext>{VV#1117 : (List.Map &lt;\lq_tmp_x1111 VV -&gt; k_1113, \lq_tmp_x1114 VV -&gt; k_1116&gt; {VV#1107 : k | k_1108} {VV#1109 : a | k_1110}) | k_1118 &amp;&amp; (VV#1117 == ds_dA9)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#1339 : (List.Map &lt;\lq_tmp_x1333 VV -&gt; k_1335, \lq_tmp_x1336 VV -&gt; k_1338&gt; {VV#1329 : k | k_1330} {VV#1331 : a | k_1332}) | k_1340 &amp;&amp; (VV#1339 == rm#auR)}</span><span class='hs-varid'>rm</span></a>
<span class=hs-linenum>238: </span>
<span class=hs-linenum>239: </span><a class=annot href="#"><span class=annottext>forall t t.
t#auS:{VV#702 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698, \lq_tmp_x699 VV -&gt; k_701&gt; {VV#692 : t | k_693} {VV#694 : t | k_695}) | k_703}
-&gt; {VV#737 : ({VV#704 : t | k_705}, {VV#706 : t | k_707}, {VV#718 : (List.Map &lt;\lq_tmp_x712 VV -&gt; k_714, \lq_tmp_x715 VV -&gt; k_717&gt; {VV#708 : t | k_709} {VV#710 : t | k_711}) | k_719})&lt;\lq_tmp_x720 VV -&gt; k_722, \lq_tmp_x723 lq_tmp_x724 VV -&gt; k_736&gt; | k_738}</span><span class='hs-definition'>deleteFindMax</span></a> <a class=annot href="#"><span class=annottext>{VV#702 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698[VV#697:=VV], \lq_tmp_x699 VV -&gt; k_701[VV#700:=VV]&gt; {VV : t | k_693[VV#692:=VV]} {VV : t | k_695[VV#694:=VV]}) | k_703}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>240: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV#702 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698[VV#697:=VV], \lq_tmp_x699 VV -&gt; k_701[VV#700:=VV]&gt; {VV : t | k_693[VV#692:=VV]} {VV : t | k_695[VV#694:=VV]}) | k_703 &amp;&amp; (VV#702 == t#auS)}</span><span class='hs-varid'>t</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>241: </span>      <span class='hs-conid'>Bin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>k</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Tip</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : t | k_693[VV#692:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; (VV == k#auU)}</span><span class='hs-varid'>k</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : t | k_695[VV#694:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; (VV == x#auV)}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#853 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698[VV#697:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL], \lq_tmp_x699 VV -&gt; k_701[VV#700:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]&gt; {VV : t | k_693[VV#692:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; k_698[VV#697:=VV][lq_tmp_x696:=k#auU][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]} {VV : t | k_695[VV#694:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]}) | (VV#853 == l#auW)}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>242: </span>      <span class='hs-conid'>Bin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>k</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#1021 : t | k_1022}</span><span class='hs-varid'>km3</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1030 : t | k_1031}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1049 : (List.Map &lt;\lq_tmp_x1043 VV -&gt; k_1045, \lq_tmp_x1046 VV -&gt; k_1048&gt; {VV#1039 : t | k_1040} {VV#1041 : t | k_1042}) | k_1050}</span><span class='hs-varid'>rm</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall t t.
t#auS:{VV#702 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698, \lq_tmp_x699 VV -&gt; k_701&gt; {VV#692 : t | k_693} {VV#694 : t | k_695}) | k_703}
-&gt; {VV#737 : ({VV#704 : t | k_705}, {VV#706 : t | k_707}, {VV#718 : (List.Map &lt;\lq_tmp_x712 VV -&gt; k_714, \lq_tmp_x715 VV -&gt; k_717&gt; {VV#708 : t | k_709} {VV#710 : t | k_711}) | k_719})&lt;\lq_tmp_x720 VV -&gt; k_722, \lq_tmp_x723 lq_tmp_x724 VV -&gt; k_736&gt; | k_738}</span><span class='hs-varid'>deleteFindMax</span></a> <a class=annot href="#"><span class=annottext>{VV#854 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698[VV#697:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL], \lq_tmp_x699 VV -&gt; k_701[VV#700:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]&gt; {VV : t | k_693[VV#692:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; k_701[VV#700:=VV][lq_tmp_x699:=k#auU][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]} {VV : t | k_695[VV#694:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]}) | (VV#854 == ds_dzL)}</span><span class='hs-varid'>r</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>243: </span>                       <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV#1021 : t | k_1022 &amp;&amp; (VV#1021 == km3#av1)}</span><span class='hs-varid'>km3</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#1030 : t | k_1031 &amp;&amp; (VV#1030 == vm#av2)}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k#avg:{VV#1058 : t | k_1059 &amp;&amp; k_140[VV#139:=VV#1058]}
-&gt; x#avh:{VV#1060 : t | k_1061 &amp;&amp; k_143[VV#142:=VV#1060]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#1058 : t | k_1059 &amp;&amp; k_146[VV#145:=VV#1058]} {VV#1060 : t | k_1061 &amp;&amp; k_148[VV#147:=VV#1060]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#1058 : t | k_1059 &amp;&amp; k_159[VV#158:=VV#1058]} {VV#1060 : t | k_1061 &amp;&amp; k_161[VV#160:=VV#1060]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#1058 : t | k_1059 &amp;&amp; k_172[VV#171:=VV#1058]} {VV#1060 : t | k_1061 &amp;&amp; k_174[VV#173:=VV#1060]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : t | k_693[VV#692:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; (VV == k#auU)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV : t | k_695[VV#694:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; (VV == x#auV)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#853 : (List.Map &lt;\lq_tmp_x696 VV -&gt; k_698[VV#697:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL], \lq_tmp_x699 VV -&gt; k_701[VV#700:=VV][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]&gt; {VV : t | k_693[VV#692:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL] &amp;&amp; k_698[VV#697:=VV][lq_tmp_x696:=k#auU][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]} {VV : t | k_695[VV#694:=VV][VV#702:=lq_anf__dBP][sz_List.Bin:=ds_dzK][key_List.Bin:=k#auU][value_List.Bin:=x#auV][left_List.Bin:=l#auW][right_List.Bin:=ds_dzL]}) | (VV#853 == l#auW)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#1049 : (List.Map &lt;\lq_tmp_x1043 VV -&gt; k_1045, \lq_tmp_x1046 VV -&gt; k_1048&gt; {VV#1039 : t | k_1040} {VV#1041 : t | k_1042}) | k_1050 &amp;&amp; (VV#1049 == rm#av3)}</span><span class='hs-varid'>rm</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>244: </span>      <span class='hs-conid'>Tip</span>           <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x0:[(GHC.Types.Char)] -&gt; {VV#794 : t | k_795}</span><span class='hs-varid'>error</span></a> <a class=annot href="#"><span class=annottext>{VV#790 : [(GHC.Types.Char)] | ((len VV#790) &gt;= 0) &amp;&amp; (VV#790 == ms#auT)}</span><span class='hs-varid'>ms</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp_x0:[(GHC.Types.Char)] -&gt; {VV#797 : t | k_798}</span><span class='hs-varid'>error</span></a> <a class=annot href="#"><span class=annottext>{VV#790 : [(GHC.Types.Char)] | ((len VV#790) &gt;= 0) &amp;&amp; (VV#790 == ms#auT)}</span><span class='hs-varid'>ms</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#812 : (List.Map &lt;\lq_tmp_x810 VV -&gt; k_809[VV#808:=VV], \lq_tmp_x806 VV -&gt; k_805[VV#804:=VV]&gt; {VV#800 : t | k_801[VV:=VV#812]} {VV#802 : t | k_803[VV:=VV#812]}) | (VV#812 == lq_anf__dBS)}</span><span class='hs-conid'>Tip</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>245: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Char)]</span><span class='hs-varid'>ms</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Char)]</span><span class='hs-str'>"Map.deleteFindMax : can not return the maximal element of an empty Map"</span></a>
<span class=hs-linenum>246: </span>
<span class=hs-linenum>247: </span><a class=annot href="#"><span class=annottext>forall t t.
t#av4:{VV#242 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238, \lq_tmp_x239 VV -&gt; k_241&gt; {VV#232 : t | k_233} {VV#234 : t | k_235}) | k_243}
-&gt; {VV#277 : ({VV#244 : t | k_245}, {VV#246 : t | k_247}, {VV#258 : (List.Map &lt;\lq_tmp_x252 VV -&gt; k_254, \lq_tmp_x255 VV -&gt; k_257&gt; {VV#248 : t | k_249} {VV#250 : t | k_251}) | k_259})&lt;\lq_tmp_x260 VV -&gt; k_262, \lq_tmp_x263 lq_tmp_x264 VV -&gt; k_276&gt; | k_278}</span><span class='hs-definition'>deleteFindMin</span></a> <a class=annot href="#"><span class=annottext>{VV#242 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238[VV#237:=VV], \lq_tmp_x239 VV -&gt; k_241[VV#240:=VV]&gt; {VV : t | k_233[VV#232:=VV]} {VV : t | k_235[VV#234:=VV]}) | k_243}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>248: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV#242 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238[VV#237:=VV], \lq_tmp_x239 VV -&gt; k_241[VV#240:=VV]&gt; {VV : t | k_233[VV#232:=VV]} {VV : t | k_235[VV#234:=VV]}) | k_243 &amp;&amp; (VV#242 == t#av4)}</span><span class='hs-varid'>t</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>249: </span>      <span class='hs-conid'>Bin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>k</span> <span class='hs-varid'>x</span> <span class='hs-conid'>Tip</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : t | k_233[VV#232:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; (VV == k#av6)}</span><span class='hs-varid'>k</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : t | k_235[VV#234:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; (VV == x#av7)}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#394 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238[VV#237:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8], \lq_tmp_x239 VV -&gt; k_241[VV#240:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]&gt; {VV : t | k_233[VV#232:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; k_241[VV#240:=VV][lq_tmp_x239:=k#av6][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]} {VV : t | k_235[VV#234:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]}) | (VV#394 == r#av8)}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>250: </span>      <span class='hs-conid'>Bin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>k</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV#561 : t | k_562}</span><span class='hs-varid'>km4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#570 : t | k_571}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#589 : (List.Map &lt;\lq_tmp_x583 VV -&gt; k_585, \lq_tmp_x586 VV -&gt; k_588&gt; {VV#579 : t | k_580} {VV#581 : t | k_582}) | k_590}</span><span class='hs-varid'>lm</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall t t.
t#av4:{VV#242 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238, \lq_tmp_x239 VV -&gt; k_241&gt; {VV#232 : t | k_233} {VV#234 : t | k_235}) | k_243}
-&gt; {VV#277 : ({VV#244 : t | k_245}, {VV#246 : t | k_247}, {VV#258 : (List.Map &lt;\lq_tmp_x252 VV -&gt; k_254, \lq_tmp_x255 VV -&gt; k_257&gt; {VV#248 : t | k_249} {VV#250 : t | k_251}) | k_259})&lt;\lq_tmp_x260 VV -&gt; k_262, \lq_tmp_x263 lq_tmp_x264 VV -&gt; k_276&gt; | k_278}</span><span class='hs-varid'>deleteFindMin</span></a> <a class=annot href="#"><span class=annottext>{VV#393 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238[VV#237:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8], \lq_tmp_x239 VV -&gt; k_241[VV#240:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]&gt; {VV : t | k_233[VV#232:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; k_238[VV#237:=VV][lq_tmp_x236:=k#av6][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]} {VV : t | k_235[VV#234:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]}) | (VV#393 == ds_dzu)}</span><span class='hs-varid'>l</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>251: </span>                       <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV#561 : t | k_562 &amp;&amp; (VV#561 == km4#avd)}</span><span class='hs-varid'>km4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#570 : t | k_571 &amp;&amp; (VV#570 == vm#ave)}</span><span class='hs-varid'>vm</span></a><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>k#avg:{VV#598 : t | k_599 &amp;&amp; k_140[VV#139:=VV#598]}
-&gt; x#avh:{VV#600 : t | k_601 &amp;&amp; k_143[VV#142:=VV#600]}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151[VV#150:=VV], \lq_tmp_x152 VV -&gt; k_154[VV#153:=VV]&gt; {VV#598 : t | k_599 &amp;&amp; k_146[VV#145:=VV#598]} {VV#600 : t | k_601 &amp;&amp; k_148[VV#147:=VV#600]}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164[VV#163:=VV], \lq_tmp_x165 VV -&gt; k_167[VV#166:=VV]&gt; {VV#598 : t | k_599 &amp;&amp; k_159[VV#158:=VV#598]} {VV#600 : t | k_601 &amp;&amp; k_161[VV#160:=VV#600]}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177[VV#176:=VV], \lq_tmp_x178 VV -&gt; k_180[VV#179:=VV]&gt; {VV#598 : t | k_599 &amp;&amp; k_172[VV#171:=VV#598]} {VV#600 : t | k_601 &amp;&amp; k_174[VV#173:=VV#600]}) | k_182}</span><span class='hs-varid'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV : t | k_233[VV#232:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; (VV == k#av6)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV : t | k_235[VV#234:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; (VV == x#av7)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#589 : (List.Map &lt;\lq_tmp_x583 VV -&gt; k_585, \lq_tmp_x586 VV -&gt; k_588&gt; {VV#579 : t | k_580} {VV#581 : t | k_582}) | k_590 &amp;&amp; (VV#589 == lm#avf)}</span><span class='hs-varid'>lm</span></a> <a class=annot href="#"><span class=annottext>{VV#394 : (List.Map &lt;\lq_tmp_x236 VV -&gt; k_238[VV#237:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8], \lq_tmp_x239 VV -&gt; k_241[VV#240:=VV][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]&gt; {VV : t | k_233[VV#232:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8] &amp;&amp; k_241[VV#240:=VV][lq_tmp_x239:=k#av6][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]} {VV : t | k_235[VV#234:=VV][VV#242:=lq_anf__dBy][sz_List.Bin:=ds_dzt][key_List.Bin:=k#av6][value_List.Bin:=x#av7][left_List.Bin:=ds_dzu][right_List.Bin:=r#av8]}) | (VV#394 == r#av8)}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>252: </span>      <span class='hs-conid'>Tip</span>             <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a-&gt; c-&gt; Bool, p2 :: a-&gt; b-&gt; Bool&gt;.
fix#x1_#40##44##44##41#:a
-&gt; fix#x2_#40##44##44##41#:{VV : b&lt;p2 fix#x1_#40##44##44##41#&gt; | true}
-&gt; fix#x3_#40##44##44##41#:{VV : c&lt;p3 fix#x2_#40##44##44##41# fix#x1_#40##44##44##41#&gt; | true}
-&gt; (a, b, c)&lt;p2, p3&gt;</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x0:[(GHC.Types.Char)] -&gt; {VV#334 : t | k_335}</span><span class='hs-varid'>error</span></a> <a class=annot href="#"><span class=annottext>{VV#330 : [(GHC.Types.Char)] | ((len VV#330) &gt;= 0) &amp;&amp; (VV#330 == ms#av5)}</span><span class='hs-varid'>ms</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp_x0:[(GHC.Types.Char)] -&gt; {VV#337 : t | k_338}</span><span class='hs-varid'>error</span></a> <a class=annot href="#"><span class=annottext>{VV#330 : [(GHC.Types.Char)] | ((len VV#330) &gt;= 0) &amp;&amp; (VV#330 == ms#av5)}</span><span class='hs-varid'>ms</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#352 : (List.Map &lt;\lq_tmp_x350 VV -&gt; k_349[VV#348:=VV], \lq_tmp_x346 VV -&gt; k_345[VV#344:=VV]&gt; {VV#340 : t | k_341[VV:=VV#352]} {VV#342 : t | k_343[VV:=VV#352]}) | (VV#352 == lq_anf__dBB)}</span><span class='hs-conid'>Tip</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>253: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Char)]</span><span class='hs-varid'>ms</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Char)]</span><span class='hs-str'>"Map.deleteFindMin : can not return the maximal element of an empty Map"</span></a>
<span class=hs-linenum>254: </span>
<span class=hs-linenum>255: </span>
<span class=hs-linenum>256: </span><span class='hs-definition'>balance</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>257: </span><a class=annot href="#"><span class=annottext>forall k a.
k#avg:{VV#139 : k | k_140}
-&gt; x#avh:{VV#142 : a | k_143}
-&gt; l#avi:{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151, \lq_tmp_x152 VV -&gt; k_154&gt; {VV#145 : k | k_146} {VV#147 : a | k_148}) | k_156}
-&gt; r#avj:{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164, \lq_tmp_x165 VV -&gt; k_167&gt; {VV#158 : k | k_159} {VV#160 : a | k_161}) | k_169}
-&gt; {VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177, \lq_tmp_x178 VV -&gt; k_180&gt; {VV#171 : k | k_172} {VV#173 : a | k_174}) | k_182}</span><span class='hs-definition'>balance</span></a> <a class=annot href="#"><span class=annottext>{VV#139 : k | k_140}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#142 : a | k_143}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#155 : (List.Map &lt;\lq_tmp_x149 VV -&gt; k_151, \lq_tmp_x152 VV -&gt; k_154&gt; {VV#145 : k | k_146} {VV#147 : a | k_148}) | k_156}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#168 : (List.Map &lt;\lq_tmp_x162 VV -&gt; k_164, \lq_tmp_x165 VV -&gt; k_167&gt; {VV#158 : k | k_159} {VV#160 : a | k_161}) | k_169}</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV#181 : (List.Map &lt;\lq_tmp_x175 VV -&gt; k_177, \lq_tmp_x178 VV -&gt; k_180&gt; {VV#171 : k | k_172} {VV#173 : a | k_174}) | k_182}</span><span class='hs-varid'>undefined</span></a>
<span class=hs-linenum>258: </span>
<span class=hs-linenum>259: </span><span class='hs-definition'>bin</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>260: </span><a class=annot href="#"><span class=annottext>forall k a.
lq_tmp_x41:k
-&gt; lq_tmp_x42:a
-&gt; lq_tmp_x43:(List.Map k a)
-&gt; lq_tmp_x44:(List.Map k a)
-&gt; (List.Map k a)</span><span class='hs-definition'>bin</span></a> <a class=annot href="#"><span class=annottext>k</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(List.Map k a)</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>(List.Map k a)</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>261: </span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall &lt;r :: k-&gt; k-&gt; Bool, l :: k-&gt; k-&gt; Bool&gt;.
sz_List.Bin:(GHC.Types.Int)
-&gt; key_List.Bin:{VV#2667 : k | k_2668}
-&gt; value_List.Bin:{VV#2669 : a | k_2670}
-&gt; left_List.Bin:(List.Map &lt;l, r&gt; {VV#2667 : k&lt;l key_List.Bin&gt; | k_2668} {VV#2669 : a | k_2670})
-&gt; right_List.Bin:(List.Map &lt;l, r&gt; {VV#2667 : k&lt;r key_List.Bin&gt; | k_2668} {VV#2669 : a | k_2670})
-&gt; (List.Map &lt;l, r&gt; {VV#2667 : k | k_2668} {VV#2669 : a | k_2670})</span><span class='hs-conid'>Bin</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>t#avo:{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119[VV#118:=VV], \lq_tmp_x120 VV -&gt; k_122[VV#121:=VV]&gt; {VV#2654 : k | k_2655 &amp;&amp; k_114[VV#113:=VV#2654]} {VV#2656 : a | k_2657 &amp;&amp; k_116[VV#115:=VV#2656]}) | k_124}
-&gt; {VV#126 : (GHC.Types.Int) | k_127}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{VV#2652 : (List.Map k a) | (VV#2652 == l#avm)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>x:(GHC.Types.Int)
-&gt; y:(GHC.Types.Int) -&gt; {VV : (GHC.Types.Int) | (VV == (x + y))}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>t#avo:{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119[VV#118:=VV], \lq_tmp_x120 VV -&gt; k_122[VV#121:=VV]&gt; {VV#2659 : k | k_2660 &amp;&amp; k_114[VV#113:=VV#2659]} {VV#2661 : a | k_2662 &amp;&amp; k_116[VV#115:=VV#2661]}) | k_124}
-&gt; {VV#126 : (GHC.Types.Int) | k_127}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{VV#2653 : (List.Map k a) | (VV#2653 == r#avn)}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>x:(GHC.Types.Int)
-&gt; y:(GHC.Types.Int) -&gt; {VV : (GHC.Types.Int) | (VV == (x + y))}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{VV#2665 : (GHC.Types.Int) | (VV#2665 == (1  :  int)) &amp;&amp; (VV#2665 == lq_anf__dDS)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : k | (VV == k#avk)}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV : a | (VV == x#avl)}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#2652 : (List.Map k a) | (VV#2652 == l#avm)}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV#2653 : (List.Map k a) | (VV#2653 == r#avn)}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>262: </span>
<span class=hs-linenum>263: </span><span class='hs-definition'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>264: </span><a class=annot href="#"><span class=annottext>forall k a.
t#avo:{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119, \lq_tmp_x120 VV -&gt; k_122&gt; {VV#113 : k | k_114} {VV#115 : a | k_116}) | k_124}
-&gt; {VV#126 : (GHC.Types.Int) | k_127}</span><span class='hs-definition'>size</span></a> <a class=annot href="#"><span class=annottext>{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119, \lq_tmp_x120 VV -&gt; k_122&gt; {VV#113 : k | k_114} {VV#115 : a | k_116}) | k_124}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>265: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV#123 : (List.Map &lt;\lq_tmp_x117 VV -&gt; k_119, \lq_tmp_x120 VV -&gt; k_122&gt; {VV#113 : k | k_114} {VV#115 : a | k_116}) | k_124 &amp;&amp; (VV#123 == t#avo)}</span><span class='hs-varid'>t</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>266: </span>      <span class='hs-conid'>Tip</span>            <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>x:(GHC.Prim.Int#) -&gt; {VV : (GHC.Types.Int) | (VV == (x  :  int))}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>267: </span>      <span class='hs-conid'>Bin</span> <span class='hs-varid'>sz</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV#132 : (GHC.Types.Int) | (VV#132 == sz#avp)}</span><span class='hs-varid'>sz</span></a>
</pre>


<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>
